<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title> Go Web Programming </title>
</head>
<script>
    window.addEventListener("load", function (evt) {
        var output = document.getElementById("output");
        var input = document.getElementById("input");
        var ws;
        /*
        var print = function (message) {
            var d = document.createElement("div");
            d.textContent = message;
            output.appendChild(d);
        };
        */
        document.getElementById("open").onclick = function (evt) {
            if (ws) {
                return false;
            }
            ws = new WebSocket("{{.}}");
            ws.onopen = function (evt) {
                ws.send("open");
            //    print("OPEN");
            }
            ws.onclose = function (evt) {
              //  print("CLOSE");
                ws = null;
            }
            ws.onmessage = function (evt) {
                var inventoryTable = document.getElementById("inventory");
                var optionHTML = "";
                var items = evt.data.split(":", 100)
                var i;
                for(i = 0; i < items.length; i++){
                    optionHTML += "\n<option>" + items[i] + "</options>";
                }
                inventoryTable.innerHTML = optionHTML;
                //print("RESPONSE: " + evt.data);
            }
            ws.onerror = function (evt) {
                //print("ERROR: " + evt.data);
            }
            return false;
        };
        document.getElementById("send").onclick = function (evt) {
            if (!ws) {
                return false;
            }
            //print("SEND: " + input.value);
            ws.send(input.value);
            return false;
        };
        document.getElementById("close").onclick = function (evt) {
            if (!ws) {
                return false;
            }
            ws.close();
            return false;
        };
    });
</script>

<body>
    <select id="inventory" size={{len .}}>
        <!-- FIll in options here -->
    </select>
    <p>Click "Open" to create a connection to the server,
        "Send" to send a message to the server and "Close" to close the connection.
        You can change the message and send multiple times.
    <p>
    <form>
        <button id="open">Open</button>
        <button id="close">Close</button>
        <p><input id="input" type="text" value="Hello world!">
            <button id="send">Send</button>
    </form>
</body>
</html>